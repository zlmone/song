package song.api.async.task.exporter;import song.common.result.BaseResult;import song.common.result.GridMapResult;import song.common.toolkit.export.ExportExcel;import song.common.toolkit.serializer.IDataSerializer;import song.common.toolkit.serializer.SerializerFactory;import song.common.toolkit.task.HandleDataHelper;import song.common.toolkit.task.async.AsyncTask;import song.common.toolkit.task.async.IAsyncTaskHandler;import java.io.IOException;/** * description: * author:          song * createDate:      2018/6/27 */public class ExcelExporterHandler implements IAsyncTaskHandler {    @Override    public BaseResult handle(AsyncTask taskInfo) throws IOException {        BaseResult result = new BaseResult();        GridMapResult data = HandleDataHelper.getGridResult(taskInfo.getHandleTypeEnum(), taskInfo.getHandleEntry());        IDataSerializer serializer = SerializerFactory.getJSONSerializer();        //获取导出参数        ExportExcel exportExcel = serializer.parseObject(taskInfo.getHandleParams(), ExportExcel.class);        //设置导出数据        if (data != null && exportExcel != null) {            exportExcel.getSheets().get(0).setRows(data.getRows());            //ExcelFactory.getWriter((WriteExcel) exportExcel).write();        }        return result;    }}