package song.api.studio.controller;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;import song.api.studio.builder.metadata.DbMetadataReader;import song.api.studio.builder.metadata.MetadataHelper;import song.api.studio.builder.transform.DbModelTransform;import song.api.studio.model.Connection;import song.api.studio.model.Table;import song.api.studio.service.impl.ConnectionService;import song.common.db.DBColumn;import song.common.db.DBConnectionConfig;import song.common.db.DBType;import song.common.io.FileHelper;import song.common.result.ActionResult;import song.common.toolkit.db.orm.DBSession;import song.common.toolkit.pdm.PdmParser;import song.common.toolkit.pdm.PdmTable;import java.util.ArrayList;import java.util.List;import java.util.Map;/** * description: * author:          song * createDate:      2018/11/26 */@RestController@RequestMapping("/datamodel")public class DataModelController {    @Autowired    private ConnectionService connectionService;    @PostMapping(value = "/filltable")    public ActionResult saveDbModel(Map<String, String> params) throws Exception {        String connectionId = params.get("connectionId");        String tableName = params.get("tableName");        Connection connection = connectionService.findById(connectionId);        DbModelTransform transform = new DbModelTransform(connection);        Table table= transform.getTable(tableName);        return null;    }    @PostMapping(value = "/pdm")    public ActionResult savePdmModel(Map<String, String> params) throws Exception {        String filePath = params.get("filePath");        if (FileHelper.exists(filePath)) {            PdmParser parser = new PdmParser(filePath);            List<PdmTable> pdmTables = parser.parse();            //解析完成，删除pdm文件            FileHelper.delete(filePath);            return new ActionResult(true);        }        return new ActionResult(false);    }}